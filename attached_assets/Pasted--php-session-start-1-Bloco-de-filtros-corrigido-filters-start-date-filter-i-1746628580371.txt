<?php
session_start();

// 1️⃣ Bloco de filtros corrigido:
$filters = [
    'start_date' => filter_input(INPUT_GET, 'start_date', FILTER_SANITIZE_SPECIAL_CHARS) ?: '',
    'end_date'   => filter_input(INPUT_GET, 'end_date',   FILTER_SANITIZE_SPECIAL_CHARS) ?: '',
    'model_id'   => filter_input(INPUT_GET, 'model_id',   FILTER_VALIDATE_INT)       ?: '',
    'status'     => filter_input(INPUT_GET, 'status',     FILTER_SANITIZE_SPECIAL_CHARS) ?: '',
    'company_id' => ($_SESSION['role'] === 'admin')
        ? (filter_input(INPUT_GET, 'company_id', FILTER_VALIDATE_INT) ?: '')
        : $_SESSION['company_id'],
];

// ... resto do código permanece igual ...

// Paginação
$currentPage = filter_input(INPUT_GET, 'page_num', FILTER_VALIDATE_INT) ?: 1;
$perPage     = 10;
$orders      = getOrders($pdo, $filters, $currentPage, $perPage);
?>

<!-- ... HTML da listagem de pedidos ... -->

<?php
// Substitua este if:
// if (!empty($orders['total'])):

// Por algo como:
if (!empty($orders['data']) && $orders['pages'] > 1): 
?>
    <div class="d-flex justify-content-center mt-4">
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <?php if ($currentPage > 1): ?>
                <li class="page-item">
                    <a
                        class="page-link"
                        href="?page=order_listing&page_num=<?php echo $currentPage - 1; ?>"
                        aria-label="Anterior"
                    >&laquo;</a>
                </li>
                <?php endif; ?>

                <?php for ($i = 1; $i <= $orders['pages']; $i++): ?>
                <li class="page-item <?php echo $currentPage === $i ? 'active' : ''; ?>">
                    <a class="page-link" href="?page=order_listing&page_num=<?php echo $i; ?>">
                        <?php echo $i; ?>
                    </a>
                </li>
                <?php endfor; ?>

                <?php if ($currentPage < $orders['pages']): ?>
                <li class="page-item">
                    <a
                        class="page-link"
                        href="?page=order_listing&page_num=<?php echo $currentPage + 1; ?>"
                        aria-label="Próxima"
                    >&raquo;</a>
                </li>
                <?php endif; ?>
            </ul>
        </nav>
    </div>
<?php endif; ?>
